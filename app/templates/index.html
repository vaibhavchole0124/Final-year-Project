<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Single Prediction | Employee Attrition</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            background: linear-gradient(180deg, #0f2a45, #0b3550);
            font-family: system-ui;
        }

        .navbar-custom {
            background: linear-gradient(90deg, #0b2a45, #0f3a5f);
            padding: 14px 30px;
        }

        .navbar-custom a {
            color: #fff;
            text-decoration: none;
            margin-left: 20px;
            font-weight: 600;
        }

        .navbar-custom .active {
            background: #d4a017;
            padding: 6px 14px;
            border-radius: 20px;
            color: #000;
        }

        .card-box {
            background: #fff;
            border-radius: 18px;
            padding: 25px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
        }

        .section {
            background: #fdf6e7;
            border-radius: 14px;
            padding: 18px;
            margin-bottom: 18px;
        }

        .section-title {
            background: #0b2a45;
            color: #fff;
            display: inline-block;
            padding: 6px 14px;
            border-radius: 10px;
            margin-bottom: 14px;
            font-weight: 600;
        }

        input,
        select {
            border-radius: 10px !important;
        }

        .predict-btn {
            background: linear-gradient(180deg, #f0b429, #d99a12);
            border: none;
            border-radius: 12px;
            padding: 14px;
            font-weight: 700;
        }

        .badge-stay {
            background: #198754;
        }

        .badge-leave {
            background: #dc3545;
        }
    </style>
</head>

<body>

    <!-- HEADER -->
    <div class="navbar-custom d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-2">
            <img src="{{ url_for('static', filename='logo.png') }}" height="36">
            <span class="fw-bold text-white">EMPLOYEE ATTRITION SYSTEM</span>
        </div>

        <div>
            <a class="active" href="/">Single</a>
            <a href="/bulk">Bulk</a>
            <a href="/dashboard">Dashboard</a>
            <a href="/logout">Logout</a>
        </div>
    </div>

    <!-- MAIN -->
    <div class="container mt-4 mb-5">
        <div class="row g-4">

            <!-- FORM -->
            <div class="col-lg-7">
                <div class="card-box">

                    <h3 class="fw-bold mb-2">Single Employee Prediction</h3>
                    <p class="text-muted mb-3">Fill employee details to predict attrition risk</p>

                    <form method="POST">

                        <!-- PERSONAL -->
                        <div class="section">
                            <div class="section-title">Personal Details</div>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label>Age</label>
                                    <input type="number" name="Age" class="form-control">
                                </div>
                                <div class="col-md-4">
                                    <label>Gender</label>
                                    <select name="Gender" class="form-select">
                                        <option value="">Select</option>
                                        <option>Male</option>
                                        <option>Female</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label>Marital Status</label>
                                    <select name="MaritalStatus" class="form-select">
                                        <option value="">Select</option>
                                        <option>Single</option>
                                        <option>Married</option>
                                        <option>Divorced</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label>Maternity/Paternity Leave</label>
                                    <select name="MaternityPaternityLeave" class="form-select">
                                        <option value="0">No</option>
                                        <option value="1">Yes</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- JOB -->
                        <div class="section">
                            <div class="section-title">Job Details</div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label>Department</label>
                                    <select name="Department" class="form-select">
                                        <option value="">Select</option>
                                        <option>Research & Development</option>
                                        <option>Sales</option>
                                        <option>Human Resources</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label>Job Role</label>
                                    <select name="JobRole" class="form-select">
                                        <option value="">Select</option>
                                        <option>Research Scientist</option>
                                        <option>Sales Executive</option>
                                        <option>Laboratory Technician</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- SALARY -->
                        <div class="section">
                            <div class="section-title">Salary & Compensation</div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label>Monthly Income</label>
                                    <input type="number" name="MonthlyIncome" class="form-control">
                                </div>
                                <div class="col-md-6">
                                    <label>Percent Salary Hike</label>
                                    <input type="number" name="PercentSalaryHike" class="form-control">
                                </div>
                            </div>
                        </div>

                        <!-- EXPERIENCE -->
                        <div class="section">
                            <div class="section-title">Experience & Tenure</div>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label>Total Working Years</label>
                                    <input type="number" name="TotalWorkingYears" class="form-control">
                                </div>
                                <div class="col-md-4">
                                    <label>Years At Company</label>
                                    <input type="number" name="YearsAtCompany" class="form-control">
                                </div>
                                <div class="col-md-4">
                                    <label>Years In Current Role</label>
                                    <input type="number" name="YearsInCurrentRole" class="form-control">
                                </div>
                            </div>
                        </div>

                        <!-- SATISFACTION -->
                        <div class="section">
                            <div class="section-title">Satisfaction & Work-Life</div>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label>Job Satisfaction (1‚Äì4)</label>
                                    <input type="number" min="1" max="4" name="JobSatisfaction" class="form-control">
                                </div>
                                <div class="col-md-4">
                                    <label>Work Life Balance (1‚Äì4)</label>
                                    <input type="number" min="1" max="4" name="WorkLifeBalance" class="form-control">
                                </div>
                                <div class="col-md-4">
                                    <label>OverTime</label>
                                    <select name="OverTime" class="form-select">
                                        <option>No</option>
                                        <option>Yes</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row g-3 mt-1">
                                <div class="col-md-6">
                                    <label>Workplace Harassment Reported?</label>
                                    <select name="WorkplaceHarassment" class="form-select">
                                        <option value="0">No</option>
                                        <option value="1">Yes</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label>Remote Work Days (0-5)</label>
                                    <input type="number" min="0" max="5" name="RemoteWorkFrequency" class="form-control"
                                        value="0">
                                </div>
                            </div>
                            <div class="row g-3 mt-1">
                                <div class="col-md-4">
                                    <label>Mental Health Support?</label>
                                    <select name="MentalHealthResources" class="form-select">
                                        <option value="0">No</option>
                                        <option value="1">Yes</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label>Deadline Pressure (1-4)</label>
                                    <input type="number" min="1" max="4" name="ProjectDeadlinePressure"
                                        class="form-control" value="2">
                                </div>
                                <div class="col-md-4">
                                    <label>Training Hours/Month</label>
                                    <input type="number" min="0" name="SkillDevelopmentHours" class="form-control"
                                        value="5">
                                </div>
                            </div>
                        </div>

                        <button class="predict-btn w-100 mt-2">
                            üë§ Predict Attrition Risk
                        </button>

                    </form>
                </div>
            </div>

            <!-- RESULT -->
            <div class="col-lg-5">
                <div class="card-box">

                    <h4 class="fw-bold mb-3">Prediction Summary</h4>

                    {% if prediction and not prediction.error %}
                    <span
                        class="badge {{ 'badge-leave' if prediction.label=='Likely to LEAVE' else 'badge-stay' }} px-3 py-2">
                        {{ prediction.label }}
                    </span>

                    <p class="mt-3"><b>Risk Score:</b> {{ prediction.risk_score }}%</p>

                    <canvas id="riskChart" height="220"></canvas>

                    <hr>

                    <h5>HR Recommendations</h5>
                    <ul>
                        {% for r in prediction.recommendations %}
                        <li>{{ r }}</li>
                        {% endfor %}
                    </ul>

                    {% if prediction.key_drivers %}
                    <div class="mt-4 p-3 bg-light border rounded">
                        <h6 class="fw-bold text-danger">‚ö†Ô∏è Why is this risk high? (Key Drivers)</h6>
                        <small class="text-muted d-block mb-2">The AI identified these factors as the biggest
                            contributors to attrition risk:</small>
                        <ul class="mb-0">
                            {% for feature in prediction.key_drivers %}
                            <li><strong>{{ feature }}</strong></li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}

                    {% else %}
                    <p class="text-muted">Submit form to see prediction</p>
                    {% endif %}

                </div>
            </div>

        </div>
    </div>

    {% if prediction and not prediction.error %}
    <script>
        new Chart(document.getElementById("riskChart"), {
            type: "doughnut",
            data: {
                datasets: [{
                    data: [{{ prediction.risk_score }}, 100 - {{ prediction.risk_score }}],
            backgroundColor: ["{{ prediction.chart_color }}", "#e5e7eb"],
            borderWidth: 0
        }]
    },
            options: { cutout: "70%", plugins: { legend: { display: false } } }
});
    </script>
    {% endif %}

</body>

</html>